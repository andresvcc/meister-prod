# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Deployment Workflow
on: 
  push: 
    branches: [master, main]
    
jobs: 
  build:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Copy repository contents via scp
        uses: appleboy/ssh-action@master
        env:
          HOST: l095r.ftp.infomaniak.com
          USERNAME: l095r_andres
          PORT: 22
          KEY: ${{ secrets.OMG_SECRET }}
          script: |
            cd meister-prod
            git pull origin master
            git status
            yarn install
            yarn run build          
